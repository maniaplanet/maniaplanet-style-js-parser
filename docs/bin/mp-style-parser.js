(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){

/*
Maniaplanet-style-js-parser
Copyright (C) 2012 Baptiste Lafontaine (http://magnetik.org)

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
var MPStyle, Parser;

Parser = require('./Parser.coffee').Parser;

MPStyle = (typeof exports !== "undefined" && exports !== null) && this || (this.MPStyle = {});

MPStyle.Parser = Parser;

window.MPStyle = MPStyle;


},{"./Parser.coffee":5}],2:[function(require,module,exports){
var Color;

Color = (function() {
  function Color() {}

  Color.hex2rgb = function(hex_color) {
    var color;
    color = parseInt(hex_color, 16);
    return [(color & 0xff0000) >> 16, (color & 0xff00) >> 8, color & 0xff];
  };

  Color.rgb12to24 = function(color) {
    return (color & 0xf00) * 0x1100 + (color & 0xf0) * 0x110 + (color & 0xf) * 0x11;
  };

  Color.rgbToLuminance = function(rgb) {
    return 0.2126 * Math.pow(rgb[0] / 255, 2.2) + 0.7151 * Math.pow(rgb[1] / 255, 2.2) + 0.0721 * Math.pow(rgb[2] / 255, 2.2);
  };

  Color.contrastRatio = function(rgb1, rgb2) {
    return (this.rgbToLuminance(this.hex2rgb(rgb1)) + 0.05) / (this.rgbToLuminance(this.hex2rgb(rgb2)) + 0.05);
  };

  return Color;

})();

exports.Color = Color;


},{}],3:[function(require,module,exports){
var LinkToken;

LinkToken = (function() {
  function LinkToken(manialink, link) {
    this.manialink = manialink != null ? manialink : false;
    this.link = link != null ? link : "";
  }

  LinkToken.prototype.toHTML = function() {
    if (this.manialink && !/^maniaplanet:/i.test(this.link)) {
      this.link = "maniaplanet://#manialink=" + this.link;
    }
    if (!this.manialink && !/^http:/i.test(this.link)) {
      this.link = "http://" + this.link;
    }
    return '<a href="' + this.link + '">';
  };

  return LinkToken;

})();

exports.LinkToken = LinkToken;


},{}],4:[function(require,module,exports){
var LinkTokenEnd;

LinkTokenEnd = (function() {
  function LinkTokenEnd() {}

  LinkTokenEnd.prototype.toHTML = function() {
    return '</a>';
  };

  return LinkTokenEnd;

})();

exports.LinkTokenEnd = LinkTokenEnd;


},{}],5:[function(require,module,exports){
var LinkToken, LinkTokenEnd, Parser, Style, Token;

Token = require('./Token.coffee').Token;

Style = require('./Style.coffee').Style;

LinkTokenEnd = require('./LinkTokenEnd.coffee').LinkTokenEnd;

LinkToken = require('./LinkToken.coffee').LinkToken;

Parser = (function() {
  function Parser(text) {
    return this.toHTML(text);
  }

  Parser.toHTML = function(text) {
    var tokens;
    return ((function() {
      var j, len, ref, results;
      ref = this.parse(text);
      results = [];
      for (j = 0, len = ref.length; j < len; j++) {
        tokens = ref[j];
        results.push(tokens.toHTML());
      }
      return results;
    }).call(this)).join('');
  };

  Parser.parse = function(text) {
    var addChar, c, color, endColor, endLink, endText, i, index, isCode, isPrettyLink, isQuickLink, j, k, len, linkLevel, nextLinkToken, nextToken, ref, ref1, ref2, ref3, style, styleStack, tok, tokens;
    isCode = false;
    isQuickLink = false;
    isPrettyLink = false;
    style = 0;
    tokens = [];
    styleStack = [];
    nextToken = new Token;
    nextLinkToken = null;
    linkLevel = 0;
    endLink = function() {
      if (nextToken.text !== '') {
        tokens.push(nextToken);
        nextToken = new Token(style);
        tokens.push(new LinkTokenEnd);
      } else if (tokens[tokens.length - 1] === nextLinkToken) {
        tokens.pop();
      } else {
        tokens.push(new LinkTokenEnd);
      }
      nextLinkToken = null;
      isQuickLink = false;
      return isPrettyLink = false;
    };
    endText = function(force) {
      if (force == null) {
        force = false;
      }
      if (force || style !== nextToken.style) {
        if (nextToken.text !== '') {
          tokens.push(nextToken);
          return nextToken = new Token(style);
        } else {
          return nextToken.style = style;
        }
      }
    };
    ref = text.split('');
    for (index = j = 0, len = ref.length; j < len; index = ++j) {
      c = ref[index];
      if (isCode === true) {
        tok = c.toLowerCase();
        switch (tok) {
          case 'i':
            style = style ^ Style.ITALIC;
            break;
          case 'o':
            style = style ^ Style.BOLD;
            break;
          case 's':
            style = style ^ Style.SHADOWED;
            break;
          case 'w':
            style = style | Style.WIDE;
            style = style & ~Style.NARROW;
            break;
          case 'n':
            style = style | Style.NARROW;
            style = style & ~Style.WIDE;
            break;
          case 'l':
          case 'h':
          case 'p':
            if (nextLinkToken != null) {
              endLink();
            } else {
              endText(true);
              nextLinkToken = new LinkToken((tok === "h" ? true : false));
              tokens.push(nextLinkToken);
              isQuickLink = true;
              isPrettyLink = true;
              linkLevel = styleStack.length;
            }
            break;
          case 'z':
            style = (ref1 = styleStack.length === 0) != null ? ref1 : {
              0: styleStack[styleStack.length - 1]
            };
            if (nextLinkToken != null) {
              endLink(true);
            }
            break;
          case 'm':
            style = style & ~(Style.NARROW | Style.WIDE);
            break;
          case 'g':
            style = style & ((ref2 = styleStack.length === 0) != null ? ref2 : ~{
              0x1fff: stylesStack[stylesStack.length(-1)] | ~0x1fff
            });
            break;
          case '<':
            styleStack.push(style);
            break;
          case '>':
            if (styleStack.length !== 0) {
              style = styleStack.pop();
              if ((nextLinkToken != null) && linkLevel > styleStack.length) {
                endLink();
              }
            }
            break;
          case '$':
            nextToken.text += '$';
            break;
          default:
            if (/[a-f0-9]/i.test(c)) {
              color = c;
            }
        }
        endText();
        isCode = false;
      } else if (c === '$') {
        isCode = true;
        if (isQuickLink && isPrettyLink) {
          isPrettyLink = false;
        }
      } else if (color != null) {
        endColor = false;
        addChar = false;
        if (/[a-f0-9]/i.test(c)) {
          color += c.replace(/[^a-f0-9]/gi, '0');
          endColor = color.length === 3;
        } else {
          for (i = k = 0, ref3 = 3 - color.length; 0 <= ref3 ? k < ref3 : k > ref3; i = 0 <= ref3 ? ++k : --k) {
            color += '0';
          }
          endColor = true;
          addChar = true;
        }
        if (endColor) {
          style = style & ~0xfff;
          style = style | Style.COLORED | (parseInt(color, 16) & 0xfff);
          endText();
          color = null;
          if (addChar) {
            nextToken.text += c;
          }
        }
      } else if (isQuickLink && isPrettyLink) {
        if (c === '[') {
          isQuickLink = false;
        } else {
          isPrettyLink = false;
          nextToken.text += c;
          nextLinkToken.link += c;
        }
      } else if (isPrettyLink) {
        if (c === ']') {
          isPrettyLink = false;
        } else {
          nextLinkToken.link += c;
        }
      } else {
        nextToken.text += c;
        if (isQuickLink) {
          nextLinkToken.link += c;
        }
      }
    }
    if (nextToken.text !== '') {
      tokens.push(nextToken);
    }
    if (nextLinkToken != null) {
      tokens.push(new LinkTokenEnd);
    }
    return tokens;
  };

  return Parser;

})();

exports.Parser = Parser;


},{"./LinkToken.coffee":3,"./LinkTokenEnd.coffee":4,"./Style.coffee":6,"./Token.coffee":7}],6:[function(require,module,exports){
var Style;

Style = (function() {
  function Style() {}

  Style.COLORED = 0x1000;

  Style.ITALIC = 0x2000;

  Style.BOLD = 0x4000;

  Style.SHADOWED = 0x8000;

  Style.CAPITALIZED = 0x10000;

  Style.WIDE = 0x20000;

  Style.NARROW = 0x40000;

  return Style;

})();

exports.Style = Style;


},{}],7:[function(require,module,exports){
var Color, Style, Token;

Style = require('./Style.coffee').Style;

Color = require('./Color.coffee').Color;

Token = (function() {
  function Token(style, text) {
    this.style = style != null ? style : 0;
    this.text = text != null ? text : '';
  }

  Token.prototype.toHTML = function() {
    var color, styleStack;
    styleStack = [];
    if (this.style) {
      if (this.style & Style.COLORED) {
        color = parseInt(Color.rgb12to24(this.style & 0xfff), 10).toString(16);
        if (color.length === 1) {
          color = '00000' + color;
        } else if (color.length === 2) {
          color = '0000' + color;
        } else if (color.length === 4) {
          color = '00' + color;
        }
        styleStack.push('color: #' + color + ';');
      }
      if (this.style & Style.ITALIC) {
        styleStack.push('font-style:italic;');
      }
      if (this.style & Style.BOLD) {
        styleStack.push('font-weight:bold;');
      }
      if (this.style & Style.SHADOWED) {
        styleStack.push('text-shadow:1px 1px 1px rgba(0, 0, 0, 0.5);');
      }
      if (this.style & Style.WIDE) {
        styleStack.push('letter-spacing:.1em;font-size:105%;');
      } else if (this.style & Style.NARROW) {
        styleStack.push('letter-spacing:-.1em;font-size:95%;');
      }
      return '<span style="' + styleStack.join(' ') + '">' + this.text + '</span>';
    } else {
      return this.text;
    }
  };

  return Token;

})();

exports.Token = Token;


},{"./Color.coffee":2,"./Style.coffee":6}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvQnJvd3Nlck1vZHVsZS5jb2ZmZWUiLCJzcmMvQ29sb3IuY29mZmVlIiwic3JjL0xpbmtUb2tlbi5jb2ZmZWUiLCJzcmMvTGlua1Rva2VuRW5kLmNvZmZlZSIsInNyYy9QYXJzZXIuY29mZmVlIiwic3JjL1N0eWxlLmNvZmZlZSIsInNyYy9Ub2tlbi5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiXG4vKlxuTWFuaWFwbGFuZXQtc3R5bGUtanMtcGFyc2VyXG5Db3B5cmlnaHQgKEMpIDIwMTIgQmFwdGlzdGUgTGFmb250YWluZSAoaHR0cDovL21hZ25ldGlrLm9yZylcblxuVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbml0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG50aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvclxuKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cblxuVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG5idXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZVxuR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cblxuWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2VcbmFsb25nIHdpdGggdGhpcyBwcm9ncmFtLiAgSWYgbm90LCBzZWUgPGh0dHA6Ly93d3cuZ251Lm9yZy9saWNlbnNlcy8+LlxuICovXG52YXIgTVBTdHlsZSwgUGFyc2VyO1xuXG5QYXJzZXIgPSByZXF1aXJlKCcuL1BhcnNlci5jb2ZmZWUnKS5QYXJzZXI7XG5cbk1QU3R5bGUgPSAodHlwZW9mIGV4cG9ydHMgIT09IFwidW5kZWZpbmVkXCIgJiYgZXhwb3J0cyAhPT0gbnVsbCkgJiYgdGhpcyB8fCAodGhpcy5NUFN0eWxlID0ge30pO1xuXG5NUFN0eWxlLlBhcnNlciA9IFBhcnNlcjtcblxud2luZG93Lk1QU3R5bGUgPSBNUFN0eWxlO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lRbkp2ZDNObGNrMXZaSFZzWlM1cWN5SXNJbk52ZFhKalpWSnZiM1FpT2lJaUxDSnpiM1Z5WTJWeklqcGJJa0p5YjNkelpYSk5iMlIxYkdVdVkyOW1abVZsSWwwc0ltNWhiV1Z6SWpwYlhTd2liV0Z3Y0dsdVozTWlPaUk3UVVGQlFUczdPenM3T3pzN096czdPenM3T3pzN1FVRkJRU3hKUVVGQk96dEJRV3RDUXl4VFFVRlZMRTlCUVVFc1EwRkJVU3hwUWtGQlVqczdRVUZGV0N4UFFVRkJMRWRCUVZVc2IwUkJRVUVzU1VGQllTeEpRVUZpTEVsQlFXdENMRU5CUVVFc1NVRkJReXhEUVVGQkxFOUJRVVFzUjBGQlZ5eEZRVUZZT3p0QlFVVTFRaXhQUVVGUExFTkJRVU1zVFVGQlVpeEhRVUZwUWpzN1FVRkZha0lzVFVGQlRTeERRVUZETEU5QlFWQXNSMEZCYVVJaWZRPT1cbiIsInZhciBDb2xvcjtcblxuQ29sb3IgPSAoZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIENvbG9yKCkge31cblxuICBDb2xvci5oZXgycmdiID0gZnVuY3Rpb24oaGV4X2NvbG9yKSB7XG4gICAgdmFyIGNvbG9yO1xuICAgIGNvbG9yID0gcGFyc2VJbnQoaGV4X2NvbG9yLCAxNik7XG4gICAgcmV0dXJuIFsoY29sb3IgJiAweGZmMDAwMCkgPj4gMTYsIChjb2xvciAmIDB4ZmYwMCkgPj4gOCwgY29sb3IgJiAweGZmXTtcbiAgfTtcblxuICBDb2xvci5yZ2IxMnRvMjQgPSBmdW5jdGlvbihjb2xvcikge1xuICAgIHJldHVybiAoY29sb3IgJiAweGYwMCkgKiAweDExMDAgKyAoY29sb3IgJiAweGYwKSAqIDB4MTEwICsgKGNvbG9yICYgMHhmKSAqIDB4MTE7XG4gIH07XG5cbiAgQ29sb3IucmdiVG9MdW1pbmFuY2UgPSBmdW5jdGlvbihyZ2IpIHtcbiAgICByZXR1cm4gMC4yMTI2ICogTWF0aC5wb3cocmdiWzBdIC8gMjU1LCAyLjIpICsgMC43MTUxICogTWF0aC5wb3cocmdiWzFdIC8gMjU1LCAyLjIpICsgMC4wNzIxICogTWF0aC5wb3cocmdiWzJdIC8gMjU1LCAyLjIpO1xuICB9O1xuXG4gIENvbG9yLmNvbnRyYXN0UmF0aW8gPSBmdW5jdGlvbihyZ2IxLCByZ2IyKSB7XG4gICAgcmV0dXJuICh0aGlzLnJnYlRvTHVtaW5hbmNlKHRoaXMuaGV4MnJnYihyZ2IxKSkgKyAwLjA1KSAvICh0aGlzLnJnYlRvTHVtaW5hbmNlKHRoaXMuaGV4MnJnYihyZ2IyKSkgKyAwLjA1KTtcbiAgfTtcblxuICByZXR1cm4gQ29sb3I7XG5cbn0pKCk7XG5cbmV4cG9ydHMuQ29sb3IgPSBDb2xvcjtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGF0YTphcHBsaWNhdGlvbi9qc29uO2Jhc2U2NCxleUoyWlhKemFXOXVJam96TENKbWFXeGxJam9pUTI5c2IzSXVhbk1pTENKemIzVnlZMlZTYjI5MElqb2lJaXdpYzI5MWNtTmxjeUk2V3lKRGIyeHZjaTVqYjJabVpXVWlYU3dpYm1GdFpYTWlPbHRkTENKdFlYQndhVzVuY3lJNklrRkJRVUVzU1VGQlFUczdRVUZCVFRzN08wVkJRMG9zUzBGQlF5eERRVUZCTEU5QlFVUXNSMEZCVlN4VFFVRkRMRk5CUVVRN1FVRkRWQ3hSUVVGQk8wbEJRVUVzUzBGQlFTeEhRVUZSTEZGQlFVRXNRMEZCVXl4VFFVRlVMRVZCUVc5Q0xFVkJRWEJDTzBGQlExSXNWMEZCVHl4RFFVRkRMRU5CUVVNc1MwRkJRU3hIUVVGUkxGRkJRVlFzUTBGQlFTeEpRVUZ6UWl4RlFVRjJRaXhGUVVFeVFpeERRVUZETEV0QlFVRXNSMEZCVVN4TlFVRlVMRU5CUVVFc1NVRkJiMElzUTBGQkwwTXNSVUZCYTBRc1MwRkJRU3hIUVVGUkxFbEJRVEZFTzBWQlJrVTdPMFZCU1ZZc1MwRkJReXhEUVVGQkxGTkJRVVFzUjBGQldTeFRRVUZETEV0QlFVUTdRVUZEVml4WFFVRlBMRU5CUVVNc1MwRkJRU3hIUVVGUkxFdEJRVlFzUTBGQlFTeEhRVUZyUWl4TlFVRnNRaXhIUVVFeVFpeERRVUZETEV0QlFVRXNSMEZCVVN4SlFVRlVMRU5CUVVFc1IwRkJhVUlzUzBGQk5VTXNSMEZCYjBRc1EwRkJReXhMUVVGQkxFZEJRVkVzUjBGQlZDeERRVUZCTEVkQlFXZENPMFZCUkdwRk96dEZRVWRhTEV0QlFVTXNRMEZCUVN4alFVRkVMRWRCUVdsQ0xGTkJRVU1zUjBGQlJEdEJRVU5vUWl4WFFVRlBMRTFCUVVFc1IwRkJVeXhKUVVGSkxFTkJRVU1zUjBGQlRDeERRVUZUTEVkQlFVa3NRMEZCUVN4RFFVRkJMRU5CUVVvc1IwRkJVeXhIUVVGc1FpeEZRVUYxUWl4SFFVRjJRaXhEUVVGVUxFZEJRWFZETEUxQlFVRXNSMEZCVXl4SlFVRkpMRU5CUVVNc1IwRkJUQ3hEUVVGVExFZEJRVWtzUTBGQlFTeERRVUZCTEVOQlFVb3NSMEZCVXl4SFFVRnNRaXhGUVVGMVFpeEhRVUYyUWl4RFFVRm9SQ3hIUVVFNFJTeE5RVUZCTEVkQlFWTXNTVUZCU1N4RFFVRkRMRWRCUVV3c1EwRkJVeXhIUVVGSkxFTkJRVUVzUTBGQlFTeERRVUZLTEVkQlFWTXNSMEZCYkVJc1JVRkJkVUlzUjBGQmRrSTdSVUZFT1VVN08wVkJUMnBDTEV0QlFVTXNRMEZCUVN4aFFVRkVMRWRCUVdkQ0xGTkJRVU1zU1VGQlJDeEZRVUZQTEVsQlFWQTdRVUZEWml4WFFVRlBMRU5CUVVNc1NVRkJReXhEUVVGQkxHTkJRVVFzUTBGQlowSXNTVUZCUXl4RFFVRkJMRTlCUVVRc1EwRkJVeXhKUVVGVUxFTkJRV2hDTEVOQlFVRXNSMEZCYTBNc1NVRkJia01zUTBGQlFTeEhRVUV5UXl4RFFVRkRMRWxCUVVNc1EwRkJRU3hqUVVGRUxFTkJRV2RDTEVsQlFVTXNRMEZCUVN4UFFVRkVMRU5CUVZNc1NVRkJWQ3hEUVVGb1FpeERRVUZCTEVkQlFXdERMRWxCUVc1RE8wVkJSRzVET3pzN096czdRVUZIYkVJc1QwRkJUeXhEUVVGRExFdEJRVklzUjBGQlowSWlmUT09XG4iLCJ2YXIgTGlua1Rva2VuO1xuXG5MaW5rVG9rZW4gPSAoZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIExpbmtUb2tlbihtYW5pYWxpbmssIGxpbmspIHtcbiAgICB0aGlzLm1hbmlhbGluayA9IG1hbmlhbGluayAhPSBudWxsID8gbWFuaWFsaW5rIDogZmFsc2U7XG4gICAgdGhpcy5saW5rID0gbGluayAhPSBudWxsID8gbGluayA6IFwiXCI7XG4gIH1cblxuICBMaW5rVG9rZW4ucHJvdG90eXBlLnRvSFRNTCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLm1hbmlhbGluayAmJiAhL15tYW5pYXBsYW5ldDovaS50ZXN0KHRoaXMubGluaykpIHtcbiAgICAgIHRoaXMubGluayA9IFwibWFuaWFwbGFuZXQ6Ly8jbWFuaWFsaW5rPVwiICsgdGhpcy5saW5rO1xuICAgIH1cbiAgICBpZiAoIXRoaXMubWFuaWFsaW5rICYmICEvXmh0dHA6L2kudGVzdCh0aGlzLmxpbmspKSB7XG4gICAgICB0aGlzLmxpbmsgPSBcImh0dHA6Ly9cIiArIHRoaXMubGluaztcbiAgICB9XG4gICAgcmV0dXJuICc8YSBocmVmPVwiJyArIHRoaXMubGluayArICdcIj4nO1xuICB9O1xuXG4gIHJldHVybiBMaW5rVG9rZW47XG5cbn0pKCk7XG5cbmV4cG9ydHMuTGlua1Rva2VuID0gTGlua1Rva2VuO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LGV5SjJaWEp6YVc5dUlqb3pMQ0ptYVd4bElqb2lUR2x1YTFSdmEyVnVMbXB6SWl3aWMyOTFjbU5sVW05dmRDSTZJaUlzSW5OdmRYSmpaWE1pT2xzaVRHbHVhMVJ2YTJWdUxtTnZabVpsWlNKZExDSnVZVzFsY3lJNlcxMHNJbTFoY0hCcGJtZHpJam9pUVVGQlFTeEpRVUZCT3p0QlFVRk5PMFZCUlZNc2JVSkJRVU1zVTBGQlJDeEZRVUZ4UWl4SlFVRnlRanRKUVVGRExFbEJRVU1zUTBGQlFTeG5RMEZCUkN4WlFVRmhPMGxCUVU4c1NVRkJReXhEUVVGQkxITkNRVUZFTEU5QlFWRTdSVUZCTjBJN08zTkNRVVZpTEUxQlFVRXNSMEZCVVN4VFFVRkJPMGxCUTA0c1NVRkJSeXhKUVVGRExFTkJRVUVzVTBGQlJDeEpRVUZsTEVOQlFVa3NaMEpCUVdkQ0xFTkJRVU1zU1VGQmFrSXNRMEZCYzBJc1NVRkJReXhEUVVGQkxFbEJRWFpDTEVOQlFYUkNPMDFCUTBVc1NVRkJReXhEUVVGQkxFbEJRVVFzUjBGQlVTd3lRa0ZCUVN4SFFVRTRRaXhKUVVGRExFTkJRVUVzUzBGRWVrTTdPMGxCUlVFc1NVRkJSeXhEUVVGSkxFbEJRVU1zUTBGQlFTeFRRVUZNTEVsQlFXMUNMRU5CUVVrc1UwRkJVeXhEUVVGRExFbEJRVllzUTBGQlpTeEpRVUZETEVOQlFVRXNTVUZCYUVJc1EwRkJNVUk3VFVGRFJTeEpRVUZETEVOQlFVRXNTVUZCUkN4SFFVRlJMRk5CUVVFc1IwRkJXU3hKUVVGRExFTkJRVUVzUzBGRWRrSTdPMEZCUlVFc1YwRkJUeXhYUVVGQkxFZEJRV01zU1VGQlF5eERRVUZCTEVsQlFXWXNSMEZCYzBJN1JVRk1ka0k3T3pzN096dEJRVTlXTEU5QlFVOHNRMEZCUXl4VFFVRlNMRWRCUVc5Q0luMD1cbiIsInZhciBMaW5rVG9rZW5FbmQ7XG5cbkxpbmtUb2tlbkVuZCA9IChmdW5jdGlvbigpIHtcbiAgZnVuY3Rpb24gTGlua1Rva2VuRW5kKCkge31cblxuICBMaW5rVG9rZW5FbmQucHJvdG90eXBlLnRvSFRNTCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAnPC9hPic7XG4gIH07XG5cbiAgcmV0dXJuIExpbmtUb2tlbkVuZDtcblxufSkoKTtcblxuZXhwb3J0cy5MaW5rVG9rZW5FbmQgPSBMaW5rVG9rZW5FbmQ7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSm1hV3hsSWpvaVRHbHVhMVJ2YTJWdVJXNWtMbXB6SWl3aWMyOTFjbU5sVW05dmRDSTZJaUlzSW5OdmRYSmpaWE1pT2xzaVRHbHVhMVJ2YTJWdVJXNWtMbU52Wm1abFpTSmRMQ0p1WVcxbGN5STZXMTBzSW0xaGNIQnBibWR6SWpvaVFVRkJRU3hKUVVGQk96dEJRVUZOTzBWQlExTXNjMEpCUVVFc1IwRkJRVHM3ZVVKQlJXSXNUVUZCUVN4SFFVRlJMRk5CUVVFN1FVRkRVQ3hYUVVGUE8wVkJSRUU3T3pzN096dEJRVWRXTEU5QlFVOHNRMEZCUXl4WlFVRlNMRWRCUVhWQ0luMD1cbiIsInZhciBMaW5rVG9rZW4sIExpbmtUb2tlbkVuZCwgUGFyc2VyLCBTdHlsZSwgVG9rZW47XG5cblRva2VuID0gcmVxdWlyZSgnLi9Ub2tlbi5jb2ZmZWUnKS5Ub2tlbjtcblxuU3R5bGUgPSByZXF1aXJlKCcuL1N0eWxlLmNvZmZlZScpLlN0eWxlO1xuXG5MaW5rVG9rZW5FbmQgPSByZXF1aXJlKCcuL0xpbmtUb2tlbkVuZC5jb2ZmZWUnKS5MaW5rVG9rZW5FbmQ7XG5cbkxpbmtUb2tlbiA9IHJlcXVpcmUoJy4vTGlua1Rva2VuLmNvZmZlZScpLkxpbmtUb2tlbjtcblxuUGFyc2VyID0gKGZ1bmN0aW9uKCkge1xuICBmdW5jdGlvbiBQYXJzZXIodGV4dCkge1xuICAgIHJldHVybiB0aGlzLnRvSFRNTCh0ZXh0KTtcbiAgfVxuXG4gIFBhcnNlci50b0hUTUwgPSBmdW5jdGlvbih0ZXh0KSB7XG4gICAgdmFyIHRva2VucztcbiAgICByZXR1cm4gKChmdW5jdGlvbigpIHtcbiAgICAgIHZhciBqLCBsZW4sIHJlZiwgcmVzdWx0cztcbiAgICAgIHJlZiA9IHRoaXMucGFyc2UodGV4dCk7XG4gICAgICByZXN1bHRzID0gW107XG4gICAgICBmb3IgKGogPSAwLCBsZW4gPSByZWYubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHtcbiAgICAgICAgdG9rZW5zID0gcmVmW2pdO1xuICAgICAgICByZXN1bHRzLnB1c2godG9rZW5zLnRvSFRNTCgpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHRzO1xuICAgIH0pLmNhbGwodGhpcykpLmpvaW4oJycpO1xuICB9O1xuXG4gIFBhcnNlci5wYXJzZSA9IGZ1bmN0aW9uKHRleHQpIHtcbiAgICB2YXIgYWRkQ2hhciwgYywgY29sb3IsIGVuZENvbG9yLCBlbmRMaW5rLCBlbmRUZXh0LCBpLCBpbmRleCwgaXNDb2RlLCBpc1ByZXR0eUxpbmssIGlzUXVpY2tMaW5rLCBqLCBrLCBsZW4sIGxpbmtMZXZlbCwgbmV4dExpbmtUb2tlbiwgbmV4dFRva2VuLCByZWYsIHJlZjEsIHJlZjIsIHJlZjMsIHN0eWxlLCBzdHlsZVN0YWNrLCB0b2ssIHRva2VucztcbiAgICBpc0NvZGUgPSBmYWxzZTtcbiAgICBpc1F1aWNrTGluayA9IGZhbHNlO1xuICAgIGlzUHJldHR5TGluayA9IGZhbHNlO1xuICAgIHN0eWxlID0gMDtcbiAgICB0b2tlbnMgPSBbXTtcbiAgICBzdHlsZVN0YWNrID0gW107XG4gICAgbmV4dFRva2VuID0gbmV3IFRva2VuO1xuICAgIG5leHRMaW5rVG9rZW4gPSBudWxsO1xuICAgIGxpbmtMZXZlbCA9IDA7XG4gICAgZW5kTGluayA9IGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKG5leHRUb2tlbi50ZXh0ICE9PSAnJykge1xuICAgICAgICB0b2tlbnMucHVzaChuZXh0VG9rZW4pO1xuICAgICAgICBuZXh0VG9rZW4gPSBuZXcgVG9rZW4oc3R5bGUpO1xuICAgICAgICB0b2tlbnMucHVzaChuZXcgTGlua1Rva2VuRW5kKTtcbiAgICAgIH0gZWxzZSBpZiAodG9rZW5zW3Rva2Vucy5sZW5ndGggLSAxXSA9PT0gbmV4dExpbmtUb2tlbikge1xuICAgICAgICB0b2tlbnMucG9wKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0b2tlbnMucHVzaChuZXcgTGlua1Rva2VuRW5kKTtcbiAgICAgIH1cbiAgICAgIG5leHRMaW5rVG9rZW4gPSBudWxsO1xuICAgICAgaXNRdWlja0xpbmsgPSBmYWxzZTtcbiAgICAgIHJldHVybiBpc1ByZXR0eUxpbmsgPSBmYWxzZTtcbiAgICB9O1xuICAgIGVuZFRleHQgPSBmdW5jdGlvbihmb3JjZSkge1xuICAgICAgaWYgKGZvcmNlID09IG51bGwpIHtcbiAgICAgICAgZm9yY2UgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChmb3JjZSB8fCBzdHlsZSAhPT0gbmV4dFRva2VuLnN0eWxlKSB7XG4gICAgICAgIGlmIChuZXh0VG9rZW4udGV4dCAhPT0gJycpIHtcbiAgICAgICAgICB0b2tlbnMucHVzaChuZXh0VG9rZW4pO1xuICAgICAgICAgIHJldHVybiBuZXh0VG9rZW4gPSBuZXcgVG9rZW4oc3R5bGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBuZXh0VG9rZW4uc3R5bGUgPSBzdHlsZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG4gICAgcmVmID0gdGV4dC5zcGxpdCgnJyk7XG4gICAgZm9yIChpbmRleCA9IGogPSAwLCBsZW4gPSByZWYubGVuZ3RoOyBqIDwgbGVuOyBpbmRleCA9ICsraikge1xuICAgICAgYyA9IHJlZltpbmRleF07XG4gICAgICBpZiAoaXNDb2RlID09PSB0cnVlKSB7XG4gICAgICAgIHRvayA9IGMudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgc3dpdGNoICh0b2spIHtcbiAgICAgICAgICBjYXNlICdpJzpcbiAgICAgICAgICAgIHN0eWxlID0gc3R5bGUgXiBTdHlsZS5JVEFMSUM7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdvJzpcbiAgICAgICAgICAgIHN0eWxlID0gc3R5bGUgXiBTdHlsZS5CT0xEO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAncyc6XG4gICAgICAgICAgICBzdHlsZSA9IHN0eWxlIF4gU3R5bGUuU0hBRE9XRUQ7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICd3JzpcbiAgICAgICAgICAgIHN0eWxlID0gc3R5bGUgfCBTdHlsZS5XSURFO1xuICAgICAgICAgICAgc3R5bGUgPSBzdHlsZSAmIH5TdHlsZS5OQVJST1c7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICduJzpcbiAgICAgICAgICAgIHN0eWxlID0gc3R5bGUgfCBTdHlsZS5OQVJST1c7XG4gICAgICAgICAgICBzdHlsZSA9IHN0eWxlICYgflN0eWxlLldJREU7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdsJzpcbiAgICAgICAgICBjYXNlICdoJzpcbiAgICAgICAgICBjYXNlICdwJzpcbiAgICAgICAgICAgIGlmIChuZXh0TGlua1Rva2VuICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgZW5kTGluaygpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZW5kVGV4dCh0cnVlKTtcbiAgICAgICAgICAgICAgbmV4dExpbmtUb2tlbiA9IG5ldyBMaW5rVG9rZW4oKHRvayA9PT0gXCJoXCIgPyB0cnVlIDogZmFsc2UpKTtcbiAgICAgICAgICAgICAgdG9rZW5zLnB1c2gobmV4dExpbmtUb2tlbik7XG4gICAgICAgICAgICAgIGlzUXVpY2tMaW5rID0gdHJ1ZTtcbiAgICAgICAgICAgICAgaXNQcmV0dHlMaW5rID0gdHJ1ZTtcbiAgICAgICAgICAgICAgbGlua0xldmVsID0gc3R5bGVTdGFjay5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICd6JzpcbiAgICAgICAgICAgIHN0eWxlID0gKHJlZjEgPSBzdHlsZVN0YWNrLmxlbmd0aCA9PT0gMCkgIT0gbnVsbCA/IHJlZjEgOiB7XG4gICAgICAgICAgICAgIDA6IHN0eWxlU3RhY2tbc3R5bGVTdGFjay5sZW5ndGggLSAxXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChuZXh0TGlua1Rva2VuICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgZW5kTGluayh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ20nOlxuICAgICAgICAgICAgc3R5bGUgPSBzdHlsZSAmIH4oU3R5bGUuTkFSUk9XIHwgU3R5bGUuV0lERSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdnJzpcbiAgICAgICAgICAgIHN0eWxlID0gc3R5bGUgJiAoKHJlZjIgPSBzdHlsZVN0YWNrLmxlbmd0aCA9PT0gMCkgIT0gbnVsbCA/IHJlZjIgOiB+e1xuICAgICAgICAgICAgICAweDFmZmY6IHN0eWxlc1N0YWNrW3N0eWxlc1N0YWNrLmxlbmd0aCgtMSldIHwgfjB4MWZmZlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICc8JzpcbiAgICAgICAgICAgIHN0eWxlU3RhY2sucHVzaChzdHlsZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICc+JzpcbiAgICAgICAgICAgIGlmIChzdHlsZVN0YWNrLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICBzdHlsZSA9IHN0eWxlU3RhY2sucG9wKCk7XG4gICAgICAgICAgICAgIGlmICgobmV4dExpbmtUb2tlbiAhPSBudWxsKSAmJiBsaW5rTGV2ZWwgPiBzdHlsZVN0YWNrLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGVuZExpbmsoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgY2FzZSAnJCc6XG4gICAgICAgICAgICBuZXh0VG9rZW4udGV4dCArPSAnJCc7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgaWYgKC9bYS1mMC05XS9pLnRlc3QoYykpIHtcbiAgICAgICAgICAgICAgY29sb3IgPSBjO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVuZFRleHQoKTtcbiAgICAgICAgaXNDb2RlID0gZmFsc2U7XG4gICAgICB9IGVsc2UgaWYgKGMgPT09ICckJykge1xuICAgICAgICBpc0NvZGUgPSB0cnVlO1xuICAgICAgICBpZiAoaXNRdWlja0xpbmsgJiYgaXNQcmV0dHlMaW5rKSB7XG4gICAgICAgICAgaXNQcmV0dHlMaW5rID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoY29sb3IgIT0gbnVsbCkge1xuICAgICAgICBlbmRDb2xvciA9IGZhbHNlO1xuICAgICAgICBhZGRDaGFyID0gZmFsc2U7XG4gICAgICAgIGlmICgvW2EtZjAtOV0vaS50ZXN0KGMpKSB7XG4gICAgICAgICAgY29sb3IgKz0gYy5yZXBsYWNlKC9bXmEtZjAtOV0vZ2ksICcwJyk7XG4gICAgICAgICAgZW5kQ29sb3IgPSBjb2xvci5sZW5ndGggPT09IDM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9yIChpID0gayA9IDAsIHJlZjMgPSAzIC0gY29sb3IubGVuZ3RoOyAwIDw9IHJlZjMgPyBrIDwgcmVmMyA6IGsgPiByZWYzOyBpID0gMCA8PSByZWYzID8gKytrIDogLS1rKSB7XG4gICAgICAgICAgICBjb2xvciArPSAnMCc7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVuZENvbG9yID0gdHJ1ZTtcbiAgICAgICAgICBhZGRDaGFyID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZW5kQ29sb3IpIHtcbiAgICAgICAgICBzdHlsZSA9IHN0eWxlICYgfjB4ZmZmO1xuICAgICAgICAgIHN0eWxlID0gc3R5bGUgfCBTdHlsZS5DT0xPUkVEIHwgKHBhcnNlSW50KGNvbG9yLCAxNikgJiAweGZmZik7XG4gICAgICAgICAgZW5kVGV4dCgpO1xuICAgICAgICAgIGNvbG9yID0gbnVsbDtcbiAgICAgICAgICBpZiAoYWRkQ2hhcikge1xuICAgICAgICAgICAgbmV4dFRva2VuLnRleHQgKz0gYztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoaXNRdWlja0xpbmsgJiYgaXNQcmV0dHlMaW5rKSB7XG4gICAgICAgIGlmIChjID09PSAnWycpIHtcbiAgICAgICAgICBpc1F1aWNrTGluayA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlzUHJldHR5TGluayA9IGZhbHNlO1xuICAgICAgICAgIG5leHRUb2tlbi50ZXh0ICs9IGM7XG4gICAgICAgICAgbmV4dExpbmtUb2tlbi5saW5rICs9IGM7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoaXNQcmV0dHlMaW5rKSB7XG4gICAgICAgIGlmIChjID09PSAnXScpIHtcbiAgICAgICAgICBpc1ByZXR0eUxpbmsgPSBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXh0TGlua1Rva2VuLmxpbmsgKz0gYztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV4dFRva2VuLnRleHQgKz0gYztcbiAgICAgICAgaWYgKGlzUXVpY2tMaW5rKSB7XG4gICAgICAgICAgbmV4dExpbmtUb2tlbi5saW5rICs9IGM7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG5leHRUb2tlbi50ZXh0ICE9PSAnJykge1xuICAgICAgdG9rZW5zLnB1c2gobmV4dFRva2VuKTtcbiAgICB9XG4gICAgaWYgKG5leHRMaW5rVG9rZW4gIT0gbnVsbCkge1xuICAgICAgdG9rZW5zLnB1c2gobmV3IExpbmtUb2tlbkVuZCk7XG4gICAgfVxuICAgIHJldHVybiB0b2tlbnM7XG4gIH07XG5cbiAgcmV0dXJuIFBhcnNlcjtcblxufSkoKTtcblxuZXhwb3J0cy5QYXJzZXIgPSBQYXJzZXI7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSm1hV3hsSWpvaVVHRnljMlZ5TG1weklpd2ljMjkxY21ObFVtOXZkQ0k2SWlJc0luTnZkWEpqWlhNaU9sc2lVR0Z5YzJWeUxtTnZabVpsWlNKZExDSnVZVzFsY3lJNlcxMHNJbTFoY0hCcGJtZHpJam9pUVVGQlFTeEpRVUZCT3p0QlFVRkRMRkZCUVZNc1QwRkJRU3hEUVVGUkxHZENRVUZTT3p0QlFVTlVMRkZCUVZNc1QwRkJRU3hEUVVGUkxHZENRVUZTT3p0QlFVTlVMR1ZCUVdkQ0xFOUJRVUVzUTBGQlVTeDFRa0ZCVWpzN1FVRkRhRUlzV1VGQllTeFBRVUZCTEVOQlFWRXNiMEpCUVZJN08wRkJSVkk3UlVGRFV5eG5Ra0ZCUXl4SlFVRkVPMEZCUTFnc1YwRkJUeXhKUVVGRExFTkJRVUVzVFVGQlJDeERRVUZSTEVsQlFWSTdSVUZFU1RzN1JVRkhZaXhOUVVGRExFTkJRVUVzVFVGQlJDeEhRVUZUTEZOQlFVTXNTVUZCUkR0QlFVTlFMRkZCUVVFN1FVRkJRU3hYUVVGUE96dEJRVUZETzBGQlFVRTdWMEZCUVN4eFEwRkJRVHM3Y1VKQlFVRXNUVUZCVFN4RFFVRkRMRTFCUVZBc1EwRkJRVHRCUVVGQk96dHBRa0ZCUkN4RFFVRTBReXhEUVVGRExFbEJRVGRETEVOQlFXdEVMRVZCUVd4RU8wVkJSRUU3TzBWQlIxUXNUVUZCUXl4RFFVRkJMRXRCUVVRc1IwRkJVU3hUUVVGRExFbEJRVVE3UVVGRFRpeFJRVUZCTzBsQlFVRXNUVUZCUVN4SFFVRlRPMGxCUTFRc1YwRkJRU3hIUVVGak8wbEJRMlFzV1VGQlFTeEhRVUZsTzBsQlJXWXNTMEZCUVN4SFFVRlJPMGxCUTFJc1RVRkJRU3hIUVVGVE8wbEJRMVFzVlVGQlFTeEhRVUZoTzBsQlEySXNVMEZCUVN4SFFVRlpMRWxCUVVrN1NVRkRhRUlzWVVGQlFTeEhRVUZuUWp0SlFVTm9RaXhUUVVGQkxFZEJRVms3U1VGRldpeFBRVUZCTEVkQlFWVXNVMEZCUVR0TlFVTlNMRWxCUVVjc1UwRkJVeXhEUVVGRExFbEJRVllzUzBGQmIwSXNSVUZCZGtJN1VVRkRSU3hOUVVGTkxFTkJRVU1zU1VGQlVDeERRVUZaTEZOQlFWbzdVVUZEUVN4VFFVRkJMRWRCUVZrc1NVRkJTU3hMUVVGS0xFTkJRVlVzUzBGQlZqdFJRVU5hTEUxQlFVMHNRMEZCUXl4SlFVRlFMRU5CUVZrc1NVRkJTU3haUVVGb1FpeEZRVWhHTzA5QlFVRXNUVUZKU3l4SlFVRkhMRTFCUVU4c1EwRkJRU3hOUVVGTkxFTkJRVU1zVFVGQlVDeEhRVUZuUWl4RFFVRm9RaXhEUVVGUUxFdEJRVFpDTEdGQlFXaERPMUZCUTBnc1RVRkJUU3hEUVVGRExFZEJRVkFzUTBGQlFTeEZRVVJITzA5QlFVRXNUVUZCUVR0UlFVZElMRTFCUVUwc1EwRkJReXhKUVVGUUxFTkJRVmtzU1VGQlNTeFpRVUZvUWl4RlFVaEhPenROUVV0TUxHRkJRVUVzUjBGQlowSTdUVUZEYUVJc1YwRkJRU3hIUVVGak8yRkJRMlFzV1VGQlFTeEhRVUZsTzBsQldsQTdTVUZqVml4UFFVRkJMRWRCUVZVc1UwRkJReXhMUVVGRU96dFJRVUZETEZGQlFWRTdPMDFCUTJwQ0xFbEJRVWNzUzBGQlFTeEpRVUZUTEV0QlFVRXNTMEZCVXl4VFFVRlRMRU5CUVVNc1MwRkJMMEk3VVVGRFJTeEpRVUZITEZOQlFWTXNRMEZCUXl4SlFVRldMRXRCUVc5Q0xFVkJRWFpDTzFWQlEwVXNUVUZCVFN4RFFVRkRMRWxCUVZBc1EwRkJXU3hUUVVGYU8ybENRVU5CTEZOQlFVRXNSMEZCV1N4SlFVRkpMRXRCUVVvc1EwRkJWU3hMUVVGV0xFVkJSbVE3VTBGQlFTeE5RVUZCTzJsQ1FVbEZMRk5CUVZNc1EwRkJReXhMUVVGV0xFZEJRV3RDTEUxQlNuQkNPMU5CUkVZN08wbEJSRkU3UVVGUlZqdEJRVUZCTEZOQlFVRXNjVVJCUVVFN08wMUJRMFVzU1VGQlJ5eE5RVUZCTEV0QlFWVXNTVUZCWWp0UlFVTkZMRWRCUVVFc1IwRkJUU3hEUVVGRExFTkJRVU1zVjBGQlJpeERRVUZCTzBGQlEwNHNaMEpCUVU4c1IwRkJVRHRCUVVGQkxHVkJRMDhzUjBGRVVEdFpRVVZKTEV0QlFVRXNSMEZCVVN4TFFVRkJMRWRCUVZFc1MwRkJTeXhEUVVGRE8wRkJSRzVDTzBGQlJGQXNaVUZIVHl4SFFVaFFPMWxCU1Vrc1MwRkJRU3hIUVVGUkxFdEJRVUVzUjBGQlVTeExRVUZMTEVOQlFVTTdRVUZFYmtJN1FVRklVQ3hsUVV0UExFZEJURkE3V1VGTlNTeExRVUZCTEVkQlFWRXNTMEZCUVN4SFFVRlJMRXRCUVVzc1EwRkJRenRCUVVSdVFqdEJRVXhRTEdWQlQwOHNSMEZRVUR0WlFWRkpMRXRCUVVFc1IwRkJVU3hMUVVGQkxFZEJRVkVzUzBGQlN5eERRVUZETzFsQlEzUkNMRXRCUVVFc1IwRkJVU3hMUVVGQkxFZEJRVkVzUTBGQlF5eExRVUZMTEVOQlFVTTdRVUZHY0VJN1FVRlFVQ3hsUVZWUExFZEJWbEE3V1VGWFNTeExRVUZCTEVkQlFWRXNTMEZCUVN4SFFVRlJMRXRCUVVzc1EwRkJRenRaUVVOMFFpeExRVUZCTEVkQlFWRXNTMEZCUVN4SFFVRlJMRU5CUVVNc1MwRkJTeXhEUVVGRE8wRkJSbkJDTzBGQlZsQXNaVUZoVHl4SFFXSlFPMEZCUVVFc1pVRmhXU3hIUVdKYU8wRkJRVUVzWlVGaGFVSXNSMEZpYWtJN1dVRmpTU3hKUVVGSExIRkNRVUZJTzJOQlEwVXNUMEZCUVN4RFFVRkJMRVZCUkVZN1lVRkJRU3hOUVVGQk8yTkJSMFVzVDBGQlFTeERRVUZSTEVsQlFWSTdZMEZEUVN4aFFVRkJMRWRCUVdkQ0xFbEJRVWtzVTBGQlNpeERRVUZqTEVOQlFVa3NSMEZCUVN4TFFVRlBMRWRCUVZZc1IwRkJiVUlzU1VGQmJrSXNSMEZCTmtJc1MwRkJPVUlzUTBGQlpEdGpRVU5vUWl4TlFVRk5MRU5CUVVNc1NVRkJVQ3hEUVVGWkxHRkJRVm83WTBGRFFTeFhRVUZCTEVkQlFXTTdZMEZEWkN4WlFVRkJMRWRCUVdVN1kwRkRaaXhUUVVGQkxFZEJRVmtzVlVGQlZTeERRVUZETEU5QlVucENPenRCUVVSaE8wRkJZbXBDTEdWQmQwSlBMRWRCZUVKUU8xbEJlVUpKTEV0QlFVRXNjVVJCUVd0RE8yTkJRVUVzUTBGQlFTeEZRVUZKTEZWQlFWY3NRMEZCUVN4VlFVRlZMRU5CUVVNc1RVRkJXQ3hIUVVGdlFpeERRVUZ3UWl4RFFVRm1PenRaUVVOc1F5eEpRVUZITEhGQ1FVRklPMk5CUTBVc1QwRkJRU3hEUVVGUkxFbEJRVklzUlVGRVJqczdRVUZHUnp0QlFYaENVQ3hsUVRSQ1R5eEhRVFZDVUR0WlFUWkNTU3hMUVVGQkxFZEJRVkVzUzBGQlFTeEhRVUZSTEVOQlFVTXNRMEZCUXl4TFFVRkxMRU5CUVVNc1RVRkJUaXhIUVVGbExFdEJRVXNzUTBGQlF5eEpRVUYwUWp0QlFVUmtPMEZCTlVKUUxHVkJPRUpQTEVkQk9VSlFPMWxCSzBKSkxFdEJRVUVzUjBGQlVTeExRVUZCTEVkQlFWRXNiVVJCUVRCQ0xFTkJRVU03WTBGQlFTeE5RVUZCTEVWQlFWVXNWMEZCV1N4RFFVRkJMRmRCUVZjc1EwRkJReXhOUVVGYUxFTkJRVzFDTEVOQlFVTXNRMEZCY0VJc1EwRkJRU3hEUVVGYUxFZEJRWEZETEVOQlFVTXNUVUZCYUVRN1lVRkJNMEk3UVVGRVlqdEJRVGxDVUN4bFFXZERUeXhIUVdoRFVEdFpRV2xEU1N4VlFVRlZMRU5CUVVNc1NVRkJXQ3hEUVVGblFpeExRVUZvUWp0QlFVUkhPMEZCYUVOUUxHVkJhME5QTEVkQmJFTlFPMWxCYlVOSkxFbEJRVWNzVlVGQlZTeERRVUZETEUxQlFWZ3NTMEZCZFVJc1EwRkJNVUk3WTBGRFJTeExRVUZCTEVkQlFWRXNWVUZCVlN4RFFVRkRMRWRCUVZnc1EwRkJRVHRqUVVOU0xFbEJRVWNzZFVKQlFVRXNTVUZCYlVJc1UwRkJRU3hIUVVGWkxGVkJRVlVzUTBGQlF5eE5RVUUzUXp0blFrRkRSU3hQUVVGQkxFTkJRVUVzUlVGRVJqdGxRVVpHT3p0QlFVUkhPMEZCYkVOUUxHVkJkVU5QTEVkQmRrTlFPMWxCZDBOSkxGTkJRVk1zUTBGQlF5eEpRVUZXTEVsQlFXdENPMEZCUkdZN1FVRjJRMUE3V1VFeVEwa3NTVUZCUnl4WFFVRlhMRU5CUVVNc1NVRkJXaXhEUVVGcFFpeERRVUZxUWl4RFFVRklPMk5CUTBVc1MwRkJRU3hIUVVGUkxFVkJSRlk3TzBGQk0wTktPMUZCTmtOQkxFOUJRVUVzUTBGQlFUdFJRVU5CTEUxQlFVRXNSMEZCVXl4TlFXaEVXRHRQUVVGQkxFMUJiVVJMTEVsQlFVY3NRMEZCUVN4TFFVRkxMRWRCUVZJN1VVRkRTQ3hOUVVGQkxFZEJRVk03VVVGRFZDeEpRVUZITEZkQlFVRXNTVUZCWjBJc1dVRkJia0k3VlVGRFJTeFpRVUZCTEVkQlFXVXNUVUZFYWtJN1UwRkdSenRQUVVGQkxFMUJUVUVzU1VGQlJ5eGhRVUZJTzFGQlEwZ3NVVUZCUVN4SFFVRlhPMUZCUTFnc1QwRkJRU3hIUVVGVk8xRkJSVllzU1VGQlJ5eFhRVUZYTEVOQlFVTXNTVUZCV2l4RFFVRnBRaXhEUVVGcVFpeERRVUZJTzFWQlEwVXNTMEZCUVN4SlFVRlRMRU5CUVVNc1EwRkJReXhQUVVGR0xFTkJRVlVzWVVGQlZpeEZRVUY1UWl4SFFVRjZRanRWUVVOVUxGRkJRVUVzUjBGQlZ5eExRVUZMTEVOQlFVTXNUVUZCVGl4TFFVRm5RaXhGUVVZM1FqdFRRVUZCTEUxQlFVRTdRVUZKUlN4bFFVRnpRaXc0UmtGQmRFSTdXVUZCUVN4TFFVRkJMRWxCUVZNN1FVRkJWRHRWUVVOQkxGRkJRVUVzUjBGQlZ6dFZRVU5ZTEU5QlFVRXNSMEZCVlN4TFFVNWFPenRSUVZGQkxFbEJRVWNzVVVGQlNEdFZRVU5GTEV0QlFVRXNSMEZCVVN4TFFVRkJMRWRCUVZFc1EwRkJRenRWUVVOcVFpeExRVUZCTEVkQlFWRXNTMEZCUVN4SFFVRlJMRXRCUVVzc1EwRkJReXhQUVVGa0xFZEJRWGRDTEVOQlFVTXNVVUZCUVN4RFFVRlRMRXRCUVZRc1JVRkJaMElzUlVGQmFFSXNRMEZCUVN4SFFVRnpRaXhMUVVGMlFqdFZRVU5vUXl4UFFVRkJMRU5CUVVFN1ZVRkRRU3hMUVVGQkxFZEJRVkU3VlVGRlVpeEpRVUZITEU5QlFVZzdXVUZEUXl4VFFVRlRMRU5CUVVNc1NVRkJWaXhKUVVGclFpeEZRVVJ1UWp0WFFVNUdPMU5CV2tjN1QwRkJRU3hOUVhGQ1FTeEpRVUZITEZkQlFVRXNTVUZCWjBJc1dVRkJia0k3VVVGRFNDeEpRVUZITEVOQlFVRXNTMEZCU3l4SFFVRlNPMVZCUTBVc1YwRkJRU3hIUVVGakxFMUJSR2hDTzFOQlFVRXNUVUZCUVR0VlFVZEZMRmxCUVVFc1IwRkJaVHRWUVVObUxGTkJRVk1zUTBGQlF5eEpRVUZXTEVsQlFXdENPMVZCUTJ4Q0xHRkJRV0VzUTBGQlF5eEpRVUZrTEVsQlFYTkNMRVZCVEhoQ08xTkJSRWM3VDBGQlFTeE5RVkZCTEVsQlFVY3NXVUZCU0R0UlFVTklMRWxCUVVjc1EwRkJRU3hMUVVGTExFZEJRVkk3VlVGRFJTeFpRVUZCTEVkQlFXVXNUVUZFYWtJN1UwRkJRU3hOUVVGQk8xVkJSMFVzWVVGQllTeERRVUZETEVsQlFXUXNTVUZCYzBJc1JVRkllRUk3VTBGRVJ6dFBRVUZCTEUxQlFVRTdVVUZQU0N4VFFVRlRMRU5CUVVNc1NVRkJWaXhKUVVGclFqdFJRVU5zUWl4SlFVRkhMRmRCUVVnN1ZVRkRSU3hoUVVGaExFTkJRVU1zU1VGQlpDeEpRVUZ6UWl4RlFVUjRRanRUUVZKSE96dEJRWFpHVUR0SlFXdEhRU3hKUVVGSExGTkJRVk1zUTBGQlF5eEpRVUZXTEV0QlFXOUNMRVZCUVhaQ08wMUJRMFVzVFVGQlRTeERRVUZETEVsQlFWQXNRMEZCV1N4VFFVRmFMRVZCUkVZN08wbEJSMEVzU1VGQlJ5eHhRa0ZCU0R0TlFVTkZMRTFCUVUwc1EwRkJReXhKUVVGUUxFTkJRVmtzU1VGQlNTeFpRVUZvUWl4RlFVUkdPenRCUVVkQkxGZEJRVTg3UlVFeFNVUTdPenM3T3p0QlFUUkpWaXhQUVVGUExFTkJRVU1zVFVGQlVpeEhRVUZwUWlKOVxuIiwidmFyIFN0eWxlO1xuXG5TdHlsZSA9IChmdW5jdGlvbigpIHtcbiAgZnVuY3Rpb24gU3R5bGUoKSB7fVxuXG4gIFN0eWxlLkNPTE9SRUQgPSAweDEwMDA7XG5cbiAgU3R5bGUuSVRBTElDID0gMHgyMDAwO1xuXG4gIFN0eWxlLkJPTEQgPSAweDQwMDA7XG5cbiAgU3R5bGUuU0hBRE9XRUQgPSAweDgwMDA7XG5cbiAgU3R5bGUuQ0FQSVRBTElaRUQgPSAweDEwMDAwO1xuXG4gIFN0eWxlLldJREUgPSAweDIwMDAwO1xuXG4gIFN0eWxlLk5BUlJPVyA9IDB4NDAwMDA7XG5cbiAgcmV0dXJuIFN0eWxlO1xuXG59KSgpO1xuXG5leHBvcnRzLlN0eWxlID0gU3R5bGU7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSm1hV3hsSWpvaVUzUjViR1V1YW5NaUxDSnpiM1Z5WTJWU2IyOTBJam9pSWl3aWMyOTFjbU5sY3lJNld5SlRkSGxzWlM1amIyWm1aV1VpWFN3aWJtRnRaWE1pT2x0ZExDSnRZWEJ3YVc1bmN5STZJa0ZCUVVFc1NVRkJRVHM3UVVGQlRUczdPMFZCUTBvc1MwRkJReXhEUVVGQkxFOUJRVVFzUjBGQlowSTdPMFZCUTJoQ0xFdEJRVU1zUTBGQlFTeE5RVUZFTEVkQlFXZENPenRGUVVOb1FpeExRVUZETEVOQlFVRXNTVUZCUkN4SFFVRm5RanM3UlVGRGFFSXNTMEZCUXl4RFFVRkJMRkZCUVVRc1IwRkJaMEk3TzBWQlEyaENMRXRCUVVNc1EwRkJRU3hYUVVGRUxFZEJRV2RDT3p0RlFVTm9RaXhMUVVGRExFTkJRVUVzU1VGQlJDeEhRVUZuUWpzN1JVRkRhRUlzUzBGQlF5eERRVUZCTEUxQlFVUXNSMEZCWjBJN096czdPenRCUVVWc1FpeFBRVUZQTEVOQlFVTXNTMEZCVWl4SFFVRm5RaUo5XG4iLCJ2YXIgQ29sb3IsIFN0eWxlLCBUb2tlbjtcblxuU3R5bGUgPSByZXF1aXJlKCcuL1N0eWxlLmNvZmZlZScpLlN0eWxlO1xuXG5Db2xvciA9IHJlcXVpcmUoJy4vQ29sb3IuY29mZmVlJykuQ29sb3I7XG5cblRva2VuID0gKGZ1bmN0aW9uKCkge1xuICBmdW5jdGlvbiBUb2tlbihzdHlsZSwgdGV4dCkge1xuICAgIHRoaXMuc3R5bGUgPSBzdHlsZSAhPSBudWxsID8gc3R5bGUgOiAwO1xuICAgIHRoaXMudGV4dCA9IHRleHQgIT0gbnVsbCA/IHRleHQgOiAnJztcbiAgfVxuXG4gIFRva2VuLnByb3RvdHlwZS50b0hUTUwgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgY29sb3IsIHN0eWxlU3RhY2s7XG4gICAgc3R5bGVTdGFjayA9IFtdO1xuICAgIGlmICh0aGlzLnN0eWxlKSB7XG4gICAgICBpZiAodGhpcy5zdHlsZSAmIFN0eWxlLkNPTE9SRUQpIHtcbiAgICAgICAgY29sb3IgPSBwYXJzZUludChDb2xvci5yZ2IxMnRvMjQodGhpcy5zdHlsZSAmIDB4ZmZmKSwgMTApLnRvU3RyaW5nKDE2KTtcbiAgICAgICAgaWYgKGNvbG9yLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgIGNvbG9yID0gJzAwMDAwJyArIGNvbG9yO1xuICAgICAgICB9IGVsc2UgaWYgKGNvbG9yLmxlbmd0aCA9PT0gMikge1xuICAgICAgICAgIGNvbG9yID0gJzAwMDAnICsgY29sb3I7XG4gICAgICAgIH0gZWxzZSBpZiAoY29sb3IubGVuZ3RoID09PSA0KSB7XG4gICAgICAgICAgY29sb3IgPSAnMDAnICsgY29sb3I7XG4gICAgICAgIH1cbiAgICAgICAgc3R5bGVTdGFjay5wdXNoKCdjb2xvcjogIycgKyBjb2xvciArICc7Jyk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5zdHlsZSAmIFN0eWxlLklUQUxJQykge1xuICAgICAgICBzdHlsZVN0YWNrLnB1c2goJ2ZvbnQtc3R5bGU6aXRhbGljOycpO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuc3R5bGUgJiBTdHlsZS5CT0xEKSB7XG4gICAgICAgIHN0eWxlU3RhY2sucHVzaCgnZm9udC13ZWlnaHQ6Ym9sZDsnKTtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLnN0eWxlICYgU3R5bGUuU0hBRE9XRUQpIHtcbiAgICAgICAgc3R5bGVTdGFjay5wdXNoKCd0ZXh0LXNoYWRvdzoxcHggMXB4IDFweCByZ2JhKDAsIDAsIDAsIDAuNSk7Jyk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5zdHlsZSAmIFN0eWxlLldJREUpIHtcbiAgICAgICAgc3R5bGVTdGFjay5wdXNoKCdsZXR0ZXItc3BhY2luZzouMWVtO2ZvbnQtc2l6ZToxMDUlOycpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLnN0eWxlICYgU3R5bGUuTkFSUk9XKSB7XG4gICAgICAgIHN0eWxlU3RhY2sucHVzaCgnbGV0dGVyLXNwYWNpbmc6LS4xZW07Zm9udC1zaXplOjk1JTsnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAnPHNwYW4gc3R5bGU9XCInICsgc3R5bGVTdGFjay5qb2luKCcgJykgKyAnXCI+JyArIHRoaXMudGV4dCArICc8L3NwYW4+JztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMudGV4dDtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIFRva2VuO1xuXG59KSgpO1xuXG5leHBvcnRzLlRva2VuID0gVG9rZW47XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsZXlKMlpYSnphVzl1SWpvekxDSm1hV3hsSWpvaVZHOXJaVzR1YW5NaUxDSnpiM1Z5WTJWU2IyOTBJam9pSWl3aWMyOTFjbU5sY3lJNld5SlViMnRsYmk1amIyWm1aV1VpWFN3aWJtRnRaWE1pT2x0ZExDSnRZWEJ3YVc1bmN5STZJa0ZCUVVFc1NVRkJRVHM3UVVGQlF5eFJRVUZUTEU5QlFVRXNRMEZCVVN4blFrRkJVanM3UVVGRFZDeFJRVUZUTEU5QlFVRXNRMEZCVVN4blFrRkJVanM3UVVGRlNqdEZRVU5UTEdWQlFVTXNTMEZCUkN4RlFVRmhMRWxCUVdJN1NVRkJReXhKUVVGRExFTkJRVUVzZDBKQlFVUXNVVUZCVXp0SlFVRkhMRWxCUVVNc1EwRkJRU3h6UWtGQlJDeFBRVUZSTzBWQlFYSkNPenRyUWtGRllpeE5RVUZCTEVkQlFWRXNVMEZCUVR0QlFVTk9MRkZCUVVFN1NVRkJRU3hWUVVGQkxFZEJRV0U3U1VGRFlpeEpRVUZITEVsQlFVTXNRMEZCUVN4TFFVRktPMDFCUTBVc1NVRkJSeXhKUVVGRExFTkJRVUVzUzBGQlJDeEhRVUZUTEV0QlFVc3NRMEZCUXl4UFFVRnNRanRSUVVWRkxFdEJRVUVzUjBGQlVTeFJRVUZCTEVOQlFWTXNTMEZCU3l4RFFVRkRMRk5CUVU0c1EwRkJaMElzU1VGQlF5eERRVUZCTEV0QlFVUXNSMEZCVXl4TFFVRjZRaXhEUVVGVUxFVkJRVEJETEVWQlFURkRMRU5CUVRaRExFTkJRVU1zVVVGQk9VTXNRMEZCZFVRc1JVRkJka1E3VVVGRFVpeEpRVUZKTEV0QlFVc3NRMEZCUXl4TlFVRk9MRXRCUVdkQ0xFTkJRWEJDTzFWQlEwVXNTMEZCUVN4SFFVRlJMRTlCUVVFc1IwRkJWU3hOUVVSd1FqdFRRVUZCTEUxQlJVc3NTVUZCU1N4TFFVRkxMRU5CUVVNc1RVRkJUaXhMUVVGblFpeERRVUZ3UWp0VlFVTklMRXRCUVVFc1IwRkJVU3hOUVVGQkxFZEJRVk1zVFVGRVpEdFRRVUZCTEUxQlJVRXNTVUZCU1N4TFFVRkxMRU5CUVVNc1RVRkJUaXhMUVVGblFpeERRVUZ3UWp0VlFVTklMRXRCUVVFc1IwRkJVU3hKUVVGQkxFZEJRVThzVFVGRVdqczdVVUZGVEN4VlFVRlZMRU5CUVVNc1NVRkJXQ3hEUVVGblFpeFZRVUZCTEVkQlFXRXNTMEZCWWl4SFFVRnhRaXhIUVVGeVF5eEZRVlJHT3p0TlFWVkJMRWxCUVVjc1NVRkJReXhEUVVGQkxFdEJRVVFzUjBGQlV5eExRVUZMTEVOQlFVTXNUVUZCYkVJN1VVRkRSU3hWUVVGVkxFTkJRVU1zU1VGQldDeERRVUZuUWl4dlFrRkJhRUlzUlVGRVJqczdUVUZGUVN4SlFVRkhMRWxCUVVNc1EwRkJRU3hMUVVGRUxFZEJRVk1zUzBGQlN5eERRVUZETEVsQlFXeENPMUZCUTBVc1ZVRkJWU3hEUVVGRExFbEJRVmdzUTBGQlowSXNiVUpCUVdoQ0xFVkJSRVk3TzAxQlJVRXNTVUZCUnl4SlFVRkRMRU5CUVVFc1MwRkJSQ3hIUVVGVExFdEJRVXNzUTBGQlF5eFJRVUZzUWp0UlFVTkZMRlZCUVZVc1EwRkJReXhKUVVGWUxFTkJRV2RDTERaRFFVRm9RaXhGUVVSR096dE5RVVZCTEVsQlFVY3NTVUZCUXl4RFFVRkJMRXRCUVVRc1IwRkJVeXhMUVVGTExFTkJRVU1zU1VGQmJFSTdVVUZEUlN4VlFVRlZMRU5CUVVNc1NVRkJXQ3hEUVVGblFpeHhRMEZCYUVJc1JVRkVSanRQUVVGQkxFMUJSVXNzU1VGQlJ5eEpRVUZETEVOQlFVRXNTMEZCUkN4SFFVRlRMRXRCUVVzc1EwRkJReXhOUVVGc1FqdFJRVU5JTEZWQlFWVXNRMEZCUXl4SlFVRllMRU5CUVdkQ0xIRkRRVUZvUWl4RlFVUkhPenRCUVVWTUxHRkJRVThzWlVGQlFTeEhRVUZyUWl4VlFVRlZMRU5CUVVNc1NVRkJXQ3hEUVVGblFpeEhRVUZvUWl4RFFVRnNRaXhIUVVGNVF5eEpRVUY2UXl4SFFVRm5SQ3hKUVVGRExFTkJRVUVzU1VGQmFrUXNSMEZCZDBRc1ZVRnlRbXBGTzB0QlFVRXNUVUZCUVR0QlFYVkNSU3hoUVVGUExFbEJRVU1zUTBGQlFTeExRWFpDVmpzN1JVRkdUVHM3T3pzN08wRkJNa0pXTEU5QlFVOHNRMEZCUXl4TFFVRlNMRWRCUVdkQ0luMD1cbiJdfQ==
